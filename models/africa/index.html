<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/TuringModels.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="/TuringModels.jl/css/jtd.css"> <link rel=icon  href="/TuringModels.jl/assets/favicon.png"> <title>Africa</title> <div class=page-wrap > <div class=side-bar > <div class=header > <a href="/TuringModels.jl/" class=title > TuringModels </a> </div> <label for=show-menu  class=show-menu >MENU</label> <input type=checkbox  id=show-menu  role=button > <div class=menu  id=side-menu > <ul class=menu-list > <li class="menu-list-item "><a href="/TuringModels.jl/" class="menu-list-link ">Home</a> <li class="menu-list-item "><a href="/TuringModels.jl/models" class="menu-list-link ">Models</a> </ul> </div> </div> <div class=main-content-wrap > <div class=main-content > <div class=main-header > <a id=github  target=_blank  href="https://github.com/StatisticalRethinkingJulia/TuringModels.jl">TuringModels on GitHub </a> </div> <div class=franklin-content > <h1>Africa</h1> </div> <div class=franklin-content ><p>This is the first Stan model in Statistical Rethinking Edition 1 &#40;page 249&#41;.</p> <div class=franklin-toc ><ol><li><a href="#data">Data</a><li><a href="#model">Model</a><li><a href="#output">Output</a><li><a href="#original_output">Original output</a><li><a href="#df">df</a></ol></div> <h2 id=data ><a href="#data">Data</a></h2> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> DataFrames
<span class=hljs-keyword >using</span> Turing
<span class=hljs-keyword >using</span> TuringModels

<span class=hljs-keyword >import</span> CSV

data_path = joinpath(TuringModels.project_root, <span class=hljs-string >&quot;data&quot;</span>, <span class=hljs-string >&quot;rugged.csv&quot;</span>)
df = CSV.read(data_path, DataFrame)

df.log_gdp = log.(df.rgdppc_2000)

<span class=hljs-comment ># TODO: &quot;Replace by dropmissing or something similar.&quot;</span>
notisnan(e) = !ismissing(e)
df = df[map(notisnan, df[:, :rgdppc_2000]), :]

df = select(df, :log_gdp, :rugged, :cont_africa);</code></pre> <p>DataFrame <code>df</code> is shown Section <a href="#df">df</a>.</p> <h2 id=model ><a href="#model">Model</a></h2> <pre><code class="julia hljs"><span class=hljs-meta >@model</span> <span class=hljs-keyword >function</span> model_fn(y, x₁, x₂)
  σ ~ truncated(Cauchy(<span class=hljs-number >0</span>, <span class=hljs-number >2</span>), <span class=hljs-number >0</span>, <span class=hljs-literal >Inf</span>)
  βAR ~ Normal(<span class=hljs-number >0</span>, <span class=hljs-number >10</span>)
  βR ~ Normal(<span class=hljs-number >0</span>, <span class=hljs-number >10</span>)
  βA ~ Normal(<span class=hljs-number >0</span>, <span class=hljs-number >10</span>)
  α ~ Normal(<span class=hljs-number >0</span>, <span class=hljs-number >100</span>)

  μ = α .+ βR * x₁ .+ βA * x₂ .+ βAR * x₁ .* x₂
  y .~ Normal.(μ, σ)
<span class=hljs-keyword >end</span>

model = model_fn(df.log_gdp, df.rugged, df.cont_africa);</code></pre> <h2 id=output ><a href="#output">Output</a></h2> <pre><code class="julia hljs">chains = sample(model, NUTS(<span class=hljs-number >0.65</span>), <span class=hljs-number >1000</span>)</code></pre><pre><code class="plaintext hljs">Chains MCMC chain (1000×17×1 Array{Float64,3}):

Iterations        = 1:1000
Thinning interval = 1
Chains            = 1
Samples per chain = 1000
parameters        = α, βA, βAR, βR, σ
internals         = acceptance_rate, hamiltonian_energy, hamiltonian_energy_error, is_accept, log_density, lp, max_hamiltonian_energy_error, n_steps, nom_step_size, numerical_error, step_size, tree_depth

Summary Statistics
  parameters      mean       std   naive_se      mcse        ess      rhat
      Symbol   Float64   Float64    Float64   Float64    Float64   Float64

           α    9.2196    0.1348     0.0043    0.0061   428.5660    0.9997
          βA   -1.9460    0.2301     0.0073    0.0104   470.0520    1.0001
         βAR    0.3951    0.1315     0.0042    0.0061   462.0088    1.0000
          βR   -0.2026    0.0757     0.0024    0.0026   461.3135    0.9994
           σ    0.9506    0.0547     0.0017    0.0026   548.0803    1.0004

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           α    8.9584    9.1305    9.2254    9.3136    9.4787
          βA   -2.3707   -2.1014   -1.9504   -1.7916   -1.4846
         βAR    0.1504    0.3045    0.3947    0.4779    0.6820
          βR   -0.3539   -0.2516   -0.2049   -0.1491   -0.0496
           σ    0.8505    0.9133    0.9500    0.9844    1.0696
</code></pre> </p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsPlots

StatsPlots.plot(chains)</code></pre> <p> <img src="/TuringModels.jl/assets/models/africa/code/output/chains.svg" alt=""> <h2 id=original_output ><a href="#original_output">Original output</a></h2> <pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
Iterations = 1:1000
Thinning interval = 1
Chains = 1,2,3,4
Samples per chain = 1000

Empirical Posterior Estimates:
          Mean         SD       Naive SE       MCSE      ESS
    a  9.22360053 0.139119116 0.0021996664 0.0034632816 1000
   bR -0.20196346 0.076106388 0.0012033477 0.0018370185 1000
   bA -1.94430980 0.227080488 0.0035904578 0.0057840746 1000
  bAR  0.39071684 0.131889143 0.0020853505 0.0032749642 1000
sigma  0.95036370 0.052161768 0.0008247500 0.0009204073 1000

Quantiles:
          2.5%       25.0%       50.0%      75.0%        97.5%
    a  8.95307475  9.12719750  9.2237750  9.31974000  9.490234250
   bR -0.35217930 -0.25334425 -0.2012855 -0.15124725 -0.054216855
   bA -2.39010825 -2.09894500 -1.9432550 -1.78643000 -1.513974250
  bAR  0.13496995  0.30095575  0.3916590  0.47887625  0.650244475
sigma  0.85376115  0.91363250  0.9484920  0.98405750  1.058573750
&quot;&quot;&quot;</span>;</code></pre> <h2 id=df ><a href="#df">df</a></h2> <pre><code class="julia hljs">df</code></pre><pre><code class="plaintext hljs">170×3 DataFrame
 Row │ log_gdp   rugged   cont_africa
     │ Float64?  Float64  Int64
─────┼────────────────────────────────
   1 │  7.49261    0.858            1
   2 │  8.21693    3.427            0
   3 │  9.93326    0.769            0
   4 │  9.40703    0.775            0
   5 │  7.79234    2.688            0
   6 │  9.21254    0.006            0
   7 │ 10.1432     0.143            0
   8 │ 10.2746     3.513            0
   9 │  7.85203    1.672            0
  10 │  6.43238    1.78             1
  11 │ 10.2148     0.388            0
  12 │  6.86612    0.141            1
  13 │  6.90617    0.236            1
  14 │  7.29918    0.186            0
  15 │  8.69604    1.479            0
  16 │  9.67584    0.231            0
  17 │  9.73963    0.055            0
  18 │  8.57451    2.311            0
  19 │  8.47681    0.164            0
  20 │  8.67748    0.607            0
  21 │  7.78275    0.853            0
  22 │  8.89575    0.24             0
  23 │  9.63499    0.963            0
  24 │  8.9493     0.181            1
  25 │  7.04582    0.197            1
  26 │ 10.2142     0.775            0
  27 │ 10.3143     4.761            0
  28 │  9.11773    2.481            0
  29 │  8.27597    1.878            0
  30 │  7.36241    0.224            1
  31 │  7.54046    0.515            1
  32 │  6.50528    0.443            1
  33 │  6.86422    0.152            1
  34 │  8.73932    0.885            0
  35 │  7.47886    3.328            1
  36 │  8.48861    2.367            1
  37 │  9.06199    2.112            0
  38 │  9.91926    2.718            0
  39 │  9.64038    0.884            0
  40 │ 10.1457     0.597            0
  41 │  7.54007    2.432            1
  42 │  8.68807    0.003            0
  43 │ 10.2664     0.189            0
  44 │  8.76574    1.641            0
  45 │  8.59747    0.51             1
  46 │  8.12368    1.278            0
  47 │  8.18822    0.723            1
  48 │  6.81551    2.481            1
  49 │  9.98805    1.689            0
  50 │  9.18633    0.123            0
  51 │  6.45487    1.57             1
  52 │ 10.1485     0.328            0
  53 │  8.50712    1.396            0
  54 │ 10.1542     1.098            0
  55 │  8.7191     0.218            1
  56 │ 10.1785     0.568            0
  57 │  7.53927    3.659            0
  58 │  7.54582    0.228            1
  59 │  7.58873    0.74             1
  60 │  7.45483    0.353            1
  61 │  6.66246    0.491            1
  62 │  9.62836    0.559            1
  63 │  9.76375    3.103            0
  64 │  8.9275     2.088            0
  65 │  8.28763    1.807            0
  66 │  8.31193    0.273            0
  67 │ 10.158      2.501            0
  68 │  7.82654    2.15             0
  69 │  9.16382    1.267            0
  70 │  7.49466    2.362            0
  71 │  9.48976    0.346            0
  72 │  8.01575    0.967            0
  73 │  7.78949    1.013            0
  74 │ 10.3265     0.513            0
  75 │  8.6702     2.445            0
  76 │ 10.2726     1.472            0
  77 │ 10.0799     1.705            0
  78 │ 10.1264     2.458            0
  79 │  8.20259    1.788            0
  80 │  8.25497    1.097            0
  81 │ 10.1743     2.132            0
  82 │  8.4326     0.372            0
  83 │  6.92631    0.669            1
  84 │  7.35244    4.287            0
  85 │  7.52783    0.54             0
  86 │  9.32587    0.006            0
  87 │  9.69106    1.96             0
  88 │  9.67777    0.245            0
  89 │  7.35877    2.553            0
  90 │  8.34671    4.197            0
  91 │  8.6342     2.147            0
  92 │  8.19576    0.65             0
  93 │  7.66037    6.202            1
  94 │  9.07878    0.175            0
  95 │ 10.9646     0.881            0
  96 │  8.97509    0.154            0
  97 │  9.82995    0.732            0
  98 │  8.16446    2.413            1
  99 │  7.19403    0.799            0
 100 │  6.71568    1.169            1
 101 │  9.11011    1.732            0
 102 │  8.70942    2.665            0
 103 │  6.65878    0.147            1
 104 │  9.81223    1.527            0
 105 │  7.39045    1.057            0
 106 │  6.77636    0.612            1
 107 │  7.45542    0.115            1
 108 │  9.17186    0.949            1
 109 │  6.37375    1.027            1
 110 │  9.09677    1.009            0
 111 │  8.70911    0.913            1
 112 │ 10.0051     1.586            0
 113 │  6.55556    0.178            1
 114 │  6.78286    0.312            1
 115 │  8.09488    0.992            0
 116 │ 10.2615     0.037            0
 117 │ 10.4402     2.409            0
 118 │  7.18756    5.043            0
 119 │  9.88405    2.038            0
 120 │  9.45169    1.109            0
 121 │  7.56288    1.949            0
 122 │  8.72654    1.54             0
 123 │  8.4601     1.347            0
 124 │  8.30091    2.028            0
 125 │  7.75179    1.589            0
 126 │  9.24969    0.297            0
 127 │ 10.0097     1.447            0
 128 │  9.81221    1.304            0
 129 │  8.42356    0.245            0
 130 │ 10.108      2.072            0
 131 │  8.6809     1.267            0
 132 │  8.86724    0.94             0
 133 │  6.94618    3.309            1
 134 │  9.42336    0.914            0
 135 │  7.42814    0.442            1
 136 │  7.26898    0.244            1
 137 │ 10.0695     0.016            0
 138 │  7.52966    1.54             0
 139 │  6.14557    0.498            1
 140 │  8.43257    1.75             0
 141 │  9.33289    1.56             0
 142 │  9.73349    2.496            0
 143 │ 10.162      0.715            0
 144 │  8.45136    3.063            1
 145 │  9.79576    4.885            1
 146 │  8.08401    0.756            0
 147 │  6.71071    0.419            1
 148 │  7.27021    0.28             1
 149 │  8.74505    1.051            0
 150 │  6.66628    5.301            0
 151 │  8.20728    0.284            0
 152 │  8.79007    0.773            0
 153 │  9.10161    0.603            0
 154 │  8.74058    0.726            1
 155 │  8.78115    2.62             0
 156 │  6.25734    0.677            1
 157 │  7.1257     0.913            1
 158 │  8.32086    0.416            0
 159 │  9.0804     0.435            0
 160 │ 10.4332     1.073            0
 161 │  7.32364    0.526            0
 162 │  8.58195    3.071            0
 163 │  8.64561    0.634            0
 164 │  7.60676    2.054            0
 165 │  8.06216    1.729            0
 166 │  8.48885    1.677            0
 167 │  6.66918    2.323            0
 168 │  9.1505     1.761            1
 169 │  6.65158    0.533            1
 170 │  7.82373    1.194            1</code></pre> <div class=page-foot > <div class=copyright > <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> Rob J Goedman, Rik Huijzer and contributors. Last modified: January 09, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> </div> <!-- end of class page-wrap-->