<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel="shortcut icon" type="image/png" href="/TuringModels.jl/assets/favicon.png"/> <link rel=stylesheet  href="/TuringModels.jl/libs/highlight/github.min.css"> <link rel=stylesheet  href="/TuringModels.jl/css/franklin.css"> <title>Multilevel Reedfrogs</title> <div class=franklin-content > <div class=top-bar > <a href="/TuringModels.jl/">TuringModels</a> </div> <h1>Multilevel Reedfrogs</h1> </div> <div class=franklin-content > <div class=franklin-toc ><ol><li><a href="#data">Data</a><li><a href="#model">Model</a><li><a href="#output">Output</a><li><a href="#original_output">Original output</a></ol></div> <h2 id=data ><a href="#data">Data</a></h2> <pre><code class="julia hljs"><span class=hljs-keyword >import</span> CSV

<span class=hljs-keyword >using</span> DataFrames
<span class=hljs-keyword >using</span> TuringModels: project_root

path = joinpath(project_root, <span class=hljs-string >&quot;data&quot;</span>, <span class=hljs-string >&quot;reedfrogs.csv&quot;</span>)
df = CSV.read(path, DataFrame; delim=<span class=hljs-string >&#x27;;&#x27;</span>)
df.tank = <span class=hljs-number >1</span>:nrow(df)
df</code></pre><pre><code class="plaintext hljs">48×6 DataFrame
 Row │ density  pred    size    surv   propsurv  tank
     │ Int64    String  String  Int64  Float64   Int64
─────┼─────────────────────────────────────────────────
   1 │      10  no      big         9  0.9           1
   2 │      10  no      big        10  1.0           2
   3 │      10  no      big         7  0.7           3
   4 │      10  no      big        10  1.0           4
   5 │      10  no      small       9  0.9           5
   6 │      10  no      small       9  0.9           6
   7 │      10  no      small      10  1.0           7
   8 │      10  no      small       9  0.9           8
   9 │      10  pred    big         4  0.4           9
  10 │      10  pred    big         9  0.9          10
  11 │      10  pred    big         7  0.7          11
  12 │      10  pred    big         6  0.6          12
  13 │      10  pred    small       7  0.7          13
  14 │      10  pred    small       5  0.5          14
  15 │      10  pred    small       9  0.9          15
  16 │      10  pred    small       9  0.9          16
  17 │      25  no      big        24  0.96         17
  18 │      25  no      big        23  0.92         18
  19 │      25  no      big        22  0.88         19
  20 │      25  no      big        25  1.0          20
  21 │      25  no      small      23  0.92         21
  22 │      25  no      small      23  0.92         22
  23 │      25  no      small      23  0.92         23
  24 │      25  no      small      21  0.84         24
  25 │      25  pred    big         6  0.24         25
  26 │      25  pred    big        13  0.52         26
  27 │      25  pred    big         4  0.16         27
  28 │      25  pred    big         9  0.36         28
  29 │      25  pred    small      13  0.52         29
  30 │      25  pred    small      20  0.8          30
  31 │      25  pred    small       8  0.32         31
  32 │      25  pred    small      10  0.4          32
  33 │      35  no      big        34  0.971429     33
  34 │      35  no      big        33  0.942857     34
  35 │      35  no      big        33  0.942857     35
  36 │      35  no      big        31  0.885714     36
  37 │      35  no      small      31  0.885714     37
  38 │      35  no      small      35  1.0          38
  39 │      35  no      small      33  0.942857     39
  40 │      35  no      small      32  0.914286     40
  41 │      35  pred    big         4  0.114286     41
  42 │      35  pred    big        12  0.342857     42
  43 │      35  pred    big        13  0.371429     43
  44 │      35  pred    big        14  0.4          44
  45 │      35  pred    small      22  0.628571     45
  46 │      35  pred    small      12  0.342857     46
  47 │      35  pred    small      31  0.885714     47
  48 │      35  pred    small      17  0.485714     48</code></pre> <h2 id=model ><a href="#model">Model</a></h2> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Turing

<span class=hljs-comment ># Thanks to Kai Xu!</span>

<span class=hljs-meta >@model</span> <span class=hljs-keyword >function</span> m12_2(density, tank, surv)
    σ ~ truncated(Cauchy(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>), <span class=hljs-number >0</span>, <span class=hljs-literal >Inf</span>)
    α ~ Normal(<span class=hljs-number >0</span>, <span class=hljs-number >1</span>)

    N_tank = length(tank)
    α_tank ~ filldist(Normal(α, σ), N_tank)

    logitp = α_tank[tank]
    surv .~ BinomialLogit.(density, logitp)
<span class=hljs-keyword >end</span>;</code></pre> <h2 id=output ><a href="#output">Output</a></h2> <pre><code class="julia hljs">chains = sample(
    m12_2(df.density, df.tank, df.surv),
    NUTS(<span class=hljs-number >0.65</span>),
    <span class=hljs-number >1000</span>
)</code></pre><pre><code class="plaintext hljs">Chains MCMC chain (1000×62×1 Array{Float64,3}):

Iterations        = 1:1000
Thinning interval = 1
Chains            = 1
Samples per chain = 1000
parameters        = α, α_tank[1], α_tank[2], α_tank[3], α_tank[4], α_tank[5], α_tank[6], α_tank[7], α_tank[8], α_tank[9], α_tank[10], α_tank[11], α_tank[12], α_tank[13], α_tank[14], α_tank[15], α_tank[16], α_tank[17], α_tank[18], α_tank[19], α_tank[20], α_tank[21], α_tank[22], α_tank[23], α_tank[24], α_tank[25], α_tank[26], α_tank[27], α_tank[28], α_tank[29], α_tank[30], α_tank[31], α_tank[32], α_tank[33], α_tank[34], α_tank[35], α_tank[36], α_tank[37], α_tank[38], α_tank[39], α_tank[40], α_tank[41], α_tank[42], α_tank[43], α_tank[44], α_tank[45], α_tank[46], α_tank[47], α_tank[48], σ
internals         = acceptance_rate, hamiltonian_energy, hamiltonian_energy_error, is_accept, log_density, lp, max_hamiltonian_energy_error, n_steps, nom_step_size, numerical_error, step_size, tree_depth

Summary Statistics
  parameters      mean       std   naive_se      mcse         ess      rhat
      Symbol   Float64   Float64    Float64   Float64     Float64   Float64

           α    1.3065    0.2558     0.0081    0.0039   1671.1656    0.9990
   α_tank[1]    2.1467    0.9067     0.0287    0.0190   1859.7833    0.9994
   α_tank[2]    3.0961    1.1317     0.0358    0.0305   1653.5196    0.9993
   α_tank[3]    0.9864    0.6738     0.0213    0.0199   1432.0102    0.9991
   α_tank[4]    3.0605    1.0516     0.0333    0.0267   1214.4191    1.0004
   α_tank[5]    2.1300    0.8758     0.0277    0.0133   1674.9818    0.9994
   α_tank[6]    2.1279    0.8948     0.0283    0.0194   1813.3020    0.9994
   α_tank[7]    3.0280    1.1051     0.0349    0.0217   1811.5194    0.9990
   α_tank[8]    2.1887    0.9221     0.0292    0.0245   1165.2181    0.9990
   α_tank[9]   -0.1629    0.6104     0.0193    0.0111   1984.1506    0.9990
  α_tank[10]    2.1092    0.8581     0.0271    0.0141   1710.6043    0.9994
  α_tank[11]    0.9707    0.6963     0.0220    0.0187   1750.2294    0.9990
  α_tank[12]    0.5937    0.6102     0.0193    0.0099   1716.7131    0.9998
  α_tank[13]    1.0019    0.7014     0.0222    0.0176   1596.4756    1.0001
  α_tank[14]    0.1881    0.5891     0.0186    0.0127   1985.2518    0.9999
  α_tank[15]    2.1555    0.8813     0.0279    0.0155   2255.8729    0.9990
  α_tank[16]    2.1305    0.8415     0.0266    0.0220   1293.2553    1.0002
  α_tank[17]    2.9123    0.8052     0.0255    0.0168   1187.0542    0.9990
  α_tank[18]    2.4135    0.6813     0.0215    0.0121   1792.1417    1.0000
  α_tank[19]    2.0128    0.5615     0.0178    0.0124   1949.4260    0.9996
  α_tank[20]    3.6738    0.9909     0.0313    0.0256   1637.2887    0.9999
  α_tank[21]    2.4143    0.6941     0.0219    0.0169   1964.9762    0.9995
  α_tank[22]    2.3872    0.6463     0.0204    0.0080   1854.4189    0.9993
  α_tank[23]    2.3680    0.6316     0.0200    0.0113   1966.7621    0.9996
  α_tank[24]    1.6921    0.5256     0.0166    0.0091   1850.9517    0.9992
  α_tank[25]   -1.0077    0.4393     0.0139    0.0084   1489.1143    1.0002
  α_tank[26]    0.1724    0.3891     0.0123    0.0062   2075.9588    0.9990
  α_tank[27]   -1.4393    0.5129     0.0162    0.0141   1752.0419    0.9992
  α_tank[28]   -0.4676    0.4057     0.0128    0.0089   1476.0932    0.9994
  α_tank[29]    0.1509    0.4048     0.0128    0.0124   1437.7389    1.0003
  α_tank[30]    1.4272    0.4853     0.0153    0.0115   1422.7034    1.0006
  α_tank[31]   -0.6223    0.4022     0.0127    0.0094   1829.2597    0.9991
  α_tank[32]   -0.2945    0.4058     0.0128    0.0132   1861.7925    1.0027
  α_tank[33]    3.1728    0.7717     0.0244    0.0169   1937.6779    0.9992
  α_tank[34]    2.6938    0.6566     0.0208    0.0207   1468.6576    0.9990
  α_tank[35]    2.7019    0.6351     0.0201    0.0138   1779.9190    0.9990
  α_tank[36]    2.0522    0.5017     0.0159    0.0088   2279.0997    0.9992
  α_tank[37]    2.0485    0.5047     0.0160    0.0142   1308.7156    0.9991
  α_tank[38]    3.8708    0.9938     0.0314    0.0261   1654.5082    0.9992
  α_tank[39]    2.6803    0.6231     0.0197    0.0190   1454.5773    1.0001
  α_tank[40]    2.3539    0.5546     0.0175    0.0116   2060.1621    0.9992
  α_tank[41]   -1.8057    0.4787     0.0151    0.0087   1613.0141    0.9990
  α_tank[42]   -0.5688    0.3591     0.0114    0.0099   1909.1400    1.0011
  α_tank[43]   -0.4524    0.3276     0.0104    0.0049   1691.2165    0.9990
  α_tank[44]   -0.3404    0.3381     0.0107    0.0085   1358.8279    0.9992
  α_tank[45]    0.5686    0.3435     0.0109    0.0091   1664.5356    1.0002
  α_tank[46]   -0.5707    0.3458     0.0109    0.0085   2098.3430    1.0002
  α_tank[47]    2.0573    0.5073     0.0160    0.0085   2012.3479    0.9990
  α_tank[48]   -0.0023    0.3249     0.0103    0.0043   1413.1873    0.9990
           σ    1.6102    0.2058     0.0065    0.0076    796.3778    0.9991

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           α    0.7900    1.1362    1.3000    1.4828    1.8000
   α_tank[1]    0.5945    1.4988    2.0882    2.7497    4.1535
   α_tank[2]    1.1862    2.2792    2.9745    3.8696    5.4530
   α_tank[3]   -0.2535    0.5160    0.9605    1.4515    2.3912
   α_tank[4]    1.2757    2.3282    2.9590    3.7323    5.3989
   α_tank[5]    0.5160    1.5234    2.0649    2.7085    3.9171
   α_tank[6]    0.5545    1.5371    2.0745    2.6286    4.0462
   α_tank[7]    1.1234    2.2512    2.9022    3.7529    5.4686
   α_tank[8]    0.5815    1.5855    2.1205    2.7070    4.1385
   α_tank[9]   -1.3855   -0.5574   -0.1763    0.2429    1.0493
  α_tank[10]    0.6411    1.5132    2.0592    2.6148    3.9041
  α_tank[11]   -0.3234    0.4697    0.9598    1.4400    2.3786
  α_tank[12]   -0.5167    0.1650    0.5964    1.0096    1.8643
  α_tank[13]   -0.3675    0.5148    1.0096    1.4465    2.3542
  α_tank[14]   -0.9219   -0.2209    0.1835    0.5914    1.3591
  α_tank[15]    0.6072    1.5604    2.0810    2.7158    3.9350
  α_tank[16]    0.7304    1.5088    2.0728    2.6209    4.0762
  α_tank[17]    1.5443    2.3586    2.8380    3.3867    4.6255
  α_tank[18]    1.2107    1.9267    2.3775    2.8553    3.8925
  α_tank[19]    0.9811    1.6257    2.0106    2.3825    3.1638
  α_tank[20]    2.0540    2.9802    3.5959    4.2076    5.8084
  α_tank[21]    1.1610    1.9447    2.3554    2.8512    3.8605
  α_tank[22]    1.2616    1.9562    2.3121    2.7967    3.8355
  α_tank[23]    1.2874    1.8958    2.3361    2.7950    3.6547
  α_tank[24]    0.7562    1.3236    1.6674    2.0541    2.7976
  α_tank[25]   -1.8588   -1.3087   -1.0037   -0.7034   -0.1428
  α_tank[26]   -0.5862   -0.1000    0.1768    0.4489    0.8968
  α_tank[27]   -2.4973   -1.7582   -1.4122   -1.0954   -0.5228
  α_tank[28]   -1.2859   -0.7444   -0.4691   -0.1870    0.2746
  α_tank[29]   -0.6321   -0.1146    0.1294    0.4140    0.9698
  α_tank[30]    0.5379    1.1001    1.3936    1.7200    2.4959
  α_tank[31]   -1.4009   -0.8881   -0.6190   -0.3552    0.1333
  α_tank[32]   -1.1331   -0.5611   -0.2720   -0.0200    0.4472
  α_tank[33]    1.8687    2.6040    3.1142    3.6377    4.7944
  α_tank[34]    1.5366    2.2498    2.6637    3.0926    4.1798
  α_tank[35]    1.6814    2.2524    2.6123    3.0989    4.0757
  α_tank[36]    1.1326    1.7086    2.0041    2.3864    3.0819
  α_tank[37]    1.1846    1.7135    1.9906    2.3662    3.1601
  α_tank[38]    2.2216    3.1744    3.7622    4.4610    6.0776
  α_tank[39]    1.5512    2.2360    2.6262    3.0786    3.9765
  α_tank[40]    1.3472    1.9613    2.3165    2.7059    3.5590
  α_tank[41]   -2.7439   -2.1261   -1.7846   -1.4641   -0.9284
  α_tank[42]   -1.2505   -0.8212   -0.5598   -0.3049    0.1224
  α_tank[43]   -1.0838   -0.6727   -0.4500   -0.2426    0.2119
  α_tank[44]   -1.0230   -0.5516   -0.3371   -0.1199    0.3043
  α_tank[45]   -0.1077    0.3462    0.5563    0.8009    1.2403
  α_tank[46]   -1.2410   -0.8014   -0.5657   -0.3345    0.0887
  α_tank[47]    1.1395    1.7157    2.0269    2.3730    3.1330
  α_tank[48]   -0.6385   -0.2053   -0.0109    0.2150    0.6842
           σ    1.2582    1.4679    1.5920    1.7394    2.0357
</code></pre> </p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsPlots

StatsPlots.plot(chains)</code></pre> <p> <img src="/TuringModels.jl/assets/models/multilevel-reedfrogs/code/output/chains.svg" alt=""> <h2 id=original_output ><a href="#original_output">Original output</a></h2> <pre><code class="julia hljs">m122rethinking = <span class=hljs-string >&quot;
                mean   sd  5.5% 94.5% n_eff Rhat
a               1.30 0.25  0.90  1.70 11662    1
sigma       1.62 0.22  1.30  1.99  6556    1
a_tank[1]   2.12 0.88  0.84  3.60 16091    1
a_tank[2]   3.05 1.10  1.52  4.92 10962    1
a_tank[3]   1.00 0.66 -0.02  2.10 18175    1
a_tank[4]   3.05 1.11  1.47  4.96 10181    1
a_tank[5]   2.13 0.87  0.85  3.62 13720    1
a_tank[6]   2.12 0.86  0.86  3.59 11628    1
a_tank[7]   3.07 1.13  1.47  5.03 10315    1
a_tank[8]   2.13 0.87  0.86  3.60 13754    1
a_tank[9]  -0.18 0.60 -1.14  0.76 18218    1
a_tank[10]  2.11 0.86  0.83  3.58 15121    1
a_tank[11]  1.00 0.67 -0.04  2.09 17390    1
a_tank[12]  0.58 0.62 -0.41  1.60 17209    1
a_tank[13]  0.99 0.66 -0.04  2.09 15225    1
a_tank[14]  0.19 0.62 -0.79  1.20 18293    1
a_tank[15]  2.13 0.89  0.83  3.63 12445    1
a_tank[16]  2.11 0.87  0.87  3.61 12385    1
a_tank[17]  2.89 0.80  1.76  4.29 12583    1
a_tank[18]  2.38 0.66  1.43  3.49 14437    1
a_tank[19]  2.00 0.58  1.12  2.99 13959    1
a_tank[20]  3.67 1.03  2.20  5.44 10629    1
a_tank[21]  2.38 0.65  1.42  3.47 15309    1
a_tank[22]  2.39 0.66  1.42  3.49 13614    1
a_tank[23]  2.40 0.67  1.41  3.53 11868    1
a_tank[24]  1.69 0.52  0.90  2.55 18468    1
a_tank[25] -1.00 0.45 -1.74 -0.30 18153    1
a_tank[26]  0.16 0.40 -0.47  0.81 21895    1
a_tank[27] -1.44 0.50 -2.28 -0.69 16718    1
a_tank[28] -0.47 0.41 -1.15  0.17 20160    1
a_tank[29]  0.15 0.40 -0.48  0.80 19401    1
a_tank[30]  1.44 0.49  0.70  2.24 15407    1
a_tank[31] -0.64 0.42 -1.33 -0.01 15356    1
a_tank[32] -0.31 0.40 -0.95  0.32 19130    1
a_tank[33]  3.18 0.78  2.06  4.55 10894    1
a_tank[34]  2.70 0.66  1.75  3.84 13573    1
a_tank[35]  2.69 0.64  1.74  3.78 13876    1
a_tank[36]  2.06 0.53  1.26  2.92 16329    1
a_tank[37]  2.06 0.51  1.29  2.91 14672    1
a_tank[38]  3.88 0.97  2.52  5.57  9349    1
a_tank[39]  2.70 0.64  1.77  3.78 13444    1
a_tank[40]  2.34 0.56  1.49  3.31 14966    1
a_tank[41] -1.82 0.48 -2.61 -1.10 14214    1
a_tank[42] -0.58 0.36 -1.16 -0.02 17203    1
a_tank[43] -0.46 0.35 -1.02  0.08 17762    1
a_tank[44] -0.34 0.34 -0.90  0.20 16740    1
a_tank[45]  0.58 0.35  0.02  1.14 18946    1
a_tank[46] -0.57 0.34 -1.13 -0.03 19761    1
a_tank[47]  2.05 0.51  1.30  2.90 15122    1
a_tank[48]  0.00 0.33 -0.53  0.53 18236    1
&quot;</span>;</code></pre> <div class=page-foot > <div class=copyright > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Rob Goedman, Richard Torkar, Rik Huijzer, Martin Trapp and contributors. Last modified: January 17, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>